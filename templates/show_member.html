{% extends "base.html" %}
{% load i18n thumbnail comments %}
{% block title %}{{ member.name }}{% endblock %}
{% block head %}
<script type="text/javascript">
  $(document).ready(function() {
    $('[title]').tooltip({
      delay: 50,
      fade: 100,
      track: true,
      showURL: false,
    });
  });
</script>
{% endblock %}

{% block sidebar %}
<p><a class="action_link{% ifequal section 'basic' %} action_link_active{% endifequal %}" href="{% url votes.views.show_member member=member.url_name %}">{% trans "General" %}</a></p>
<p><a class="action_link{% ifequal section 'votes' %} action_link_active{% endifequal %}" href="{% url votes.views.show_member member=member.url_name section='votes' %}">{% trans "Votes" %}</a></p>
<p class="action_link_disabled">{% trans "Register of interest" %}</p>
<p><a class="action_link{% ifequal section 'statements' %} action_link_active{% endifequal %}" href="{% url votes.views.show_member member=member.url_name section='statements' %}">{% trans "Statements" %}</a></p>
<p><a class="action_link{% ifequal section 'comments' %} action_link_active{% endifequal %}" href="{% url votes.views.show_member member=member.url_name section='comments' %}">{% trans "Comments" %}</a></p>
{% endblock %}

{% block content %}
    <h1>{{ member.name }}</h1>

{% comment %}---------------- BASIC ----------------{% endcomment %}
{% ifequal section "basic" %}
    <div id="member_info">
    <a href="{{ member.info_link }}"><img class="member_portrait" src="/static/{% thumbnail member.photo 128x192 %}" /></a>
        <img class="member_party_logo" src="/static/{% thumbnail member.party.logo 96x96 %}" />
    <table>
    <tr><td class='member_info_field_name'>{% trans "Surname" %}</td><td>{{ member.surname }}</td></tr>
    <tr><td class='member_info_field_name'>{% trans "Given names" %}</td><td>{{ member.given_names }}</td></tr>
    <tr><td class='member_info_field_name'>{% trans "Birthdate" %}</td><td>{{ member.birth_date|date }}</td></tr>
    <tr></tr>
{% if member.email %}
    <tr><td class='member_info_field_name'>{% trans "Email address" %}</td><td>{{ member.email }}</td></tr>
{% endif %}
{% if member.phone %}
    <tr><td class='member_info_field_name'>{% trans "Telephone" %}</td><td>{{ member.phone }}</td></tr>
{% endif %}
{% if member.da_list.count %}
      <tr><td class='member_info_field_name'>{% trans "Electoral districts" %}</td>
      <td><ul>
{% for da in member.da_list %}
	<li>{{ da.name }} {{ da.begin|date }}&#8211;{% if da.end %}{{ da.end|date }}{% endif %}</li>
{% endfor %}
      </ul></td></tr>
{% endif %}
{% if member.pa_list.count %}
      <tr><td class='member_info_field_name'>{% trans "Party associations" %}</td>
      <td><ul>
{% for pa in member.pa_list %}
	<li>{{ pa.party.full_name }} {{ pa.begin|date }}&#8211;{% if pa.end %}{{ pa.end|date }}{% endif %}</li>
{% endfor %}
      </ul></td></tr>
{% endif %}
    </table>
    </div>

    <div id="stats">
{% with stats_table as table %}
{% include "_table.html" %}
{% endwith %}
    </div>
{% endifequal %}

{% comment %}---------------- VOTES ----------------{% endcomment %}
{% ifequal section "votes" %}
{% if vote_page %}
    <table id="member_vote_list">
      <tr>
        <th>{% trans "Session" %} &#x25bc;</th>
        <th>{% trans "Vote" %}</th>
      </tr>
    {% for vote in vote_page.object_list %}
    {% with vote.session as sess %}
       <tr>
          <td class="member_info_session"><a href="{% url votes.views.show_session plsess=sess.plenary_session.url_name,sess=sess.number %}">{{ vote.session.plenary_session.name }}/{{ vote.session.number }}</a></td>
    {% ifequal vote.vote 'Y' %}
          <td class="yes_vote member_info_vote" title='{% trans "Yay" %}'></td>
    {% endifequal %}
    {% ifequal vote.vote 'N' %}
          <td class="no_vote member_info_vote" title='{% trans "Nay" %}'></td>
    {% endifequal %}
    {% ifequal vote.vote 'E' %}
          <td class="empty_vote member_info_vote" title='{% trans "Empty" %}'></td>
    {% endifequal %}
          <td style="padding-left: 8px; font-size: 80%">{{ sess.info|truncatewords:8 }}</td>
        </tr>
    {% endwith %}
    {% endfor %}
    </table>
{% load pagination_nav %}
{% pagination_nav_qs vote_page "" request.GET %}
{% else %}
    <h2>{% trans "No votes in database" %}</h2>
{% endif %}
{% endifequal %}

{% comment %}---------------- COMMENTS ----------------{% endcomment %}
{% ifequal section "comments" %}
{% get_comment_list for member as comment_list %}
{% for comment in comment_list %}
<div class="comment">
  <div class="user_portrait">
    <img src="/static/images/icons/anon.png" />
  </div>
  <div class="comment_body">{{ comment.comment|linebreaks }}</div>
  <div class="comment_meta">
    <div class="comment_author">{{ comment.user_name }}</div>
    <div class="comment_date">{{ comment.submit_date|timesince }} {% trans "ago" %}</div>
  </div>
  <div class="clear"></div>
</div>
{% endfor %}
<br />
<div id="new_comment">
  <h3>{% trans "Leave a new comment" %}</h3>
  {% render_comment_form for member %}
</div>
{% endifequal %}

{% comment %}---------------- STATEMENTS ----------------{% endcomment %}
{% ifequal section "statements" %}
{% if statement_page %}
{% load pagination_nav %}

{% for st in statement_page.object_list %}
<h3>{{ st.plenary_session }}</h3>
<p>{{ st.plenary_session.date|date }}</p>
<p>
{{ st.html|safe }}
</p>
{% endfor %}

{% pagination_nav_qs statement_page "" request.GET %}

{% else %}
  <h2>{% trans "No statements found" %}</h2>
{% endif %}
{% endifequal %}

{% endblock %}

